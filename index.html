<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Tap or Die</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(() => console.log('Service Worker Registered'))
                .catch(err => console.log('SW Fail:', err));
        }
    </script>
</head>

<body>
    <div id="game-container">
        <!-- HUD -->
        <div id="hud">
            <div id="score-container">
                <span id="score-label">SCORE</span>
                <span id="score-value">0</span>
            </div>

            <div id="combo-container" class="hidden">
                <span id="combo-value">x1</span>
                <span id="combo-label">COMBO</span>
            </div>

            <div id="level-container">
                <span id="level-label">LEVEL</span>
                <span id="level-value">1</span>
            </div>

            <div id="best-container">
                <span id="best-label">BEST</span>
                <span id="best-value">0</span>
            </div>
        </div>

        <button id="pause-btn" class="icon-btn hidden">II</button>

        <!-- Play Area -->
        <div id="play-area">
            <!-- Targets will be spawned here -->
        </div>

        <!-- Pause Menu -->
        <div id="pause-menu" class="hidden">
            <h2>PAUSED</h2>
            <button id="resume-btn">RESUME</button>
            <div style="display: flex; gap: 10px; width: 100%; max-width: 250px;">
                <button id="quit-btn" class="secondary-btn" style="flex: 2;">QUIT</button>
                <button id="pause-sound-btn" class="secondary-btn" style="flex: 1; min-width: 60px;">ðŸ”Š</button>
            </div>
        </div>

        <!-- Start / Game Over Screen -->
        <div id="ui-overlay" class="active">
            <div class="panel">
                <h1 id="title-text">TAP<br>OR<br><span class="danger">DIE</span></h1>
                <div id="result-box" class="hidden">
                    <p>GAME OVER</p>
                    <p class="final-score">Score: <span id="final-score-value">0</span></p>
                    <p class="final-score" style="font-size: 16px !important; color: #ffd700;">+<span
                            id="coins-earned">0</span> ðŸª™</p>
                    <button id="revive-btn" class="secondary-btn"
                        style="margin-bottom: 10px; border: 1px solid #ffd700; color: #ffd700;">REVIVE (100 ðŸª™)</button>
                </div>
                <div style="display: flex; flex-direction: column; gap: 10px; width: 100%; max-width: 250px;">
                    <button id="start-btn" style="background: var(--skin-color); color: #000;">INFINITE MODE</button>
                    <button id="mission-btn-trigger" class="secondary-btn">MISSION MODE</button>
                </div>
                <div style="display: flex; gap: 10px; width: 100%; max-width: 250px; margin-top: 10px;">
                    <button id="shop-btn-trigger" class="secondary-btn" style="flex: 1;">SHOP</button>
                    <button id="progression-btn-trigger" class="secondary-btn" style="flex: 1;">PROGRESS</button>
                    <button id="sound-btn" class="secondary-btn" style="flex: 1; min-width: 60px;">ðŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Shop Modal -->
        <div id="shop-modal" class="hidden">
            <div class="shop-content">
                <h2>SHOP</h2>
                <div class="shop-tabs" style="display:flex; gap:10px; margin-bottom:10px;">
                    <button id="tab-skins" class="secondary-btn" style="flex:1; padding:5px;">SKINS</button>
                    <button id="tab-trails" class="secondary-btn" style="flex:1; padding:5px;">TRAILS</button>
                    <button id="tab-bgs" class="secondary-btn" style="flex:1; padding:5px;">BGS</button>
                </div>
                <p class="shop-balance" style="margin-bottom:10px;">COINS: <span id="shop-coins-value">0</span></p>
                <div id="skin-grid">
                    <!-- Skins injected by JS -->
                </div>

                <button id="close-shop">CLOSE</button>
            </div>
        </div>

        <!-- Progression Modal -->
        <div id="progression-modal" class="hidden">
            <div class="shop-content">
                <h2>PROGRESSION</h2>
                <h3 style="color:#fff; text-align:center; margin-top:20px;">DAILY CHALLENGES</h3>
                <div id="challenges-list"
                    style="color:#888; font-size:12px; display:flex; flex-direction:column; gap:5px; padding:10px;">
                    <!-- Challenges injected by JS -->
                </div>

                <h3 style="color:#fff; text-align:center; margin-top:20px;">ACHIEVEMENTS</h3>
                <div id="achievements-list"
                    style="color:#888; font-size:12px; display:flex; flex-direction:column; gap:5px; padding:10px;">
                    <!-- Achievements injected by JS -->
                </div>
                <button id="close-progression">CLOSE</button>
            </div>
        </div>

        <!-- Missions Modal -->
        <div id="mission-modal" class="hidden">
            <div class="shop-content">
                <h2>MISSIONS</h2>
                <div id="mission-grid">
                    <!-- Missions injected by JS -->
                </div>
                <button id="close-missions">CLOSE</button>
            </div>
        </div>
    </div>

    <!-- Game Logic -->
    <!-- Capacitor Native Bridge (Added for Mobile) -->
    <script src="capacitor.js"></script>
    <script src="game.js"></script>
</body>

</html>